(function(f){var m=f.document,g=f.CAGE||{},d=!1;g.util=g.util||{};"classList"in m.createElement("a")&&(d=!0);var c=function(a,b){return RegExp("^.*"+b+".*$").test(a.className)?!0:!1},k=function(a,b){this.hasClass(a,b)||(a.className=""==a.className?b:a.className+(" "+b))},a={object:{extend:function(a,b){for(var h in b)a[h]=b[h];return a}},dom:{hasClass:function(){return d?function(a,b){return a.classList.contains(b)}:c}(),addClass:function(){return d?function(a,b){return a.classList.add(b)}:k}(),removeClass:function(){return d?
function(a,b){return a.classList.remove(b)}:k}()},string:{trim:function(){return"trim"in String.prototype?function(a){return String.prototype.trim.call(a)}:function(a){return this.ltrim(this.rtrim(a))}}(),rtrim:function(a){return"trimRight"in String.prototype?function(a){return String.prototype.trimRight.call(a)}:function(a){return a.replace(/\s*$/,"")}}(),ltrim:function(a){return"trimLeft"in String.prototype?function(a){return String.prototype.trimLeft.call(a)}:function(a){return a.replace(/^\s*/,
"")}}()},template:{compiler:function(c,b){var h=a.string.trim(b),l;for(l in c)if(0===c[l]||c[l])h=h.replace("\x3c%\x3d "+l+" %\x3e",c[l]);return h},getCompiler:function(){return this.compiler},get:function(a){var c=null;g.ajax.GET({url:a.url,isAsync:!1,callback:function(a){c=JSON.parse(a).data.template}});return c}}};g.util=a;"undefined"!==typeof module&&module.exports?module.exports=g:f.CAGE=g})(this);
(function(f){function m(){try{var a=new XMLHttpRequest}catch(c){try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(h){a=null}}}return a}function g(a){return"\n"===a.substring(a.length-1)?a.substring(0,a.length-1):a}function d(a){var n=a.method,b=a.headers,h=a.url,l=a.callback,r=a.data,f=a.isAsync,p=a.success,d=a.failure;if(void 0!=h){void 0==f&&(f=!0);var e=m();if(void 0==e)c.log("Unable to create request");else{e.open(n,h,f);void 0!==l&&e.addEventListener("readystatechange",
function(a){4==e.readyState&&200==e.status&&(a=e.responseText,"\n"===a.substring(a.length-1)&&(a=a.substring(0,a.length-1)),l(a))},!1);void 0!==p&&e.addEventListener("load",function(a){a=a.target;if(200<=e.status&&300>e.status||304==e.status){g(e.responseText);var h=JSON.parse(e.responseText),c=h.status;200<=c&&300>c||304==c?p(h):(h=new CustomEvent("error",{detail:h}),a.dispatchEvent(h))}},!1);void 0!==d&&e.addEventListener("error",function(a){void 0!==e.detail?d(e.detail):(g(e.responseText),a=JSON.parse(e.responseText),
d(a))},!1);if(void 0!==b)for(var k in b)e.setRequestHeader(k,b[k]);e.send(r)}}}var c=f.console,k=f.CAGE||{};k.ajax=k.ajax||{};k.ajax={GET:function(a){a.method="GET";d(a)},POST:function(a){a.method="POST";a.headers={"Content-Type":"application/x-www-form-urlencoded"};d(a)},PUT:function(a){a.method="PUT";a.headers={"Content-Type":"application/x-www-form-urlencoded"};d(a)},DELETE:function(a){a.method="DELETE";d(a)}};"undefined"!==typeof module&&module.exports?module.exports=k:f.CAGE=k})(this);
(function(f){function m(a){this.type=a;this.eventHandlers=[]}function g(a){this.el=a.element;this.template=a.template;this.transitionEffect=a.transitionEffect?a.transitionEffect:"zoom";this.afteropen=new m("afteropen");this.afterclose=new m("afterclose");this.status={data:!1};this._init()}function d(a){this.el=a.element;this.template="!";this.transitionEffect=a.transitionEffect?a.transitionEffect:"zoom";this.templateUrl=a.templateUrl;this.templateLoader=a.templateLoader?a.templateLoader:function(a){return a};
this.afteropen=new m("afteropen");this.afterclose=new m("afterclose");this.status={data:!1};this._init()}var c=f.document,k=f.console,a=f.CAGE||{};a.ui=a.ui||{};a.ui.popup=a.ui.popup||{};var n=a.util.dom,b=a.ajax;m.prototype.add=function(a){this.eventHandlers.push(a)};m.prototype.remove=function(a){var c=this.eventHandlers,b;for(b in c)c[b]===a&&c.splice(b,1)};m.prototype.dispatch=function(){var a=this.eventHandlers,c=void 0,b;for(b in a)c=arguments[b]?arguments[b]:void 0,a[b](c)};g.prototype._init=
function(){function a(b){if("-webkit-transform"===b.propertyName&&!1===d.data){c.querySelector(".popup-wrap.popup-animation").removeEventListener("webkitTransitionEnd",a,!1);g.dispatch(c.querySelector(".popup-content"));d.data=!d.data;var l=c.querySelector(".popup-bg"),k=c.querySelector(".popup-wrap"),q=c.querySelector(".popup-container"),s=c.querySelector(".popup-content");c.addEventListener("keyup",function(a){27==a.keyCode&&m()},!1);q.addEventListener("click",function(a){if(a.target===q||a.target===
s)n.removeClass(l,"popup-ready"),n.removeClass(k,"popup-ready"),l.addEventListener("transitionend",function(a){if("opacity"===a.propertyName&&!0===d.data){f.dispatch(c.querySelector(".popup-content"));d.data=!d.data;a=c.querySelector(".popup-bg");var b=c.querySelector(".popup-wrap");a?c.body.removeChild(a):void 0;b?c.body.removeChild(b):void 0}}.bind(this),!1)},!1)}}var l=this.el,g=this.afteropen,f=this.afterclose,d=this.status,m=this.close;l.addEventListener("click",function(e){b.GET({url:this.templateUrl,
callback:function(b){k.log(b);this.template=this.templateLoader(b);e.preventDefault();e.stopPropagation();var d;e.toElement?d=e.toElement:e.originalTarget&&(d=e.originalTarget);d===l&&(this._counstructDOM(),c.querySelector(".popup-wrap.popup-animation").addEventListener("transitionend",a,!1))}.bind(this)})}.bind(this),!1)};g.prototype.open=function(){this.el.click()};g.prototype.close=function(){c.querySelector(".popup-container").click()};g.prototype._getTemplate=function(){return this.template};
g.prototype._counstructDOM=function(){var a=this.transitionEffect,b=c.createElement("div");n.addClass(b,"popup-bg");n.addClass(b,"popup-animation");var d=c.createElement("div");n.addClass(d,"popup-wrap");n.addClass(d,"popup-animation");var g=c.createElement("div");n.addClass(g,"popup-container");var f=c.createElement("div");n.addClass(f,"popup-content");f.innerHTML=this._getTemplate();g.appendChild(f);void 0!=a&&n.addClass(f,a+"-animation-dialog");d.appendChild(g);c.body.insertAdjacentHTML("afterbegin",
d.outerHTML);c.body.insertAdjacentHTML("afterbegin",b.outerHTML);(a=c.querySelector(".popup-wrap button[data-role\x3d'close']"))&&a.addEventListener("click",this.closePopup,!1);a=c.querySelector(".popup-wrap.popup-animation");b=c.querySelector(".popup-bg.popup-animation");a.offsetHeight;b.offsetHeight;b.style.transform="translateY(0px)";n.addClass(a,"popup-ready");n.addClass(b,"popup-ready")};d.prototype=g.prototype;a.ui.popup={popup:g,ajaxPopup:d};"undefined"!==typeof module&&module.exports?module.exports=
a:f.CAGE=a})(this);